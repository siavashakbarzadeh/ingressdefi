{"version":3,"file":"modal-container.component.js","sources":["../../../../src/modal/modal-container.component.ts"],"names":[],"mappings":"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","sourcesContent":["import {\n  Component,\n  ElementRef,\n  HostListener,\n  OnDestroy,\n  OnInit,\n  Renderer2\n} from '@angular/core';\nimport {\n  CLASS_NAME,\n  DISMISS_REASONS,\n  ModalOptions,\n  TRANSITION_DURATIONS\n} from './modal-options.class';\nimport { BsModalService } from './bs-modal.service';\nimport { isBs3 } from 'ngx-bootstrap/utils';\n\n@Component({\n  selector: 'modal-container',\n  template: `\n    <div [class]=\"'modal-dialog' + (config.class ? ' ' + config.class : '')\"\n         role=\"document\"\n         focusTrap>\n      <div class=\"modal-content\">\n        <ng-content></ng-content>\n      </div>\n    </div>\n  `,\n  // eslint-disable-next-line @angular-eslint/no-host-metadata-property\n  host: {\n    class: 'modal',\n    role: 'dialog',\n    tabindex: '-1',\n    '[attr.aria-modal]': 'true',\n    '[attr.aria-labelledby]': 'config.ariaLabelledBy',\n    '[attr.aria-describedby]': 'config.ariaDescribedby'\n  }\n})\nexport class ModalContainerComponent implements OnInit, OnDestroy {\n  config: ModalOptions;\n  isShown = false;\n  level?: number;\n  isAnimated = false;\n  bsModalService?: BsModalService;\n  private isModalHiding = false;\n  private clickStartedInContent = false;\n\n  constructor(options: ModalOptions,\n              protected _element: ElementRef,\n              private _renderer: Renderer2) {\n    this.config = Object.assign({}, options);\n  }\n\n  ngOnInit(): void {\n    if (this.isAnimated) {\n      this._renderer.addClass(\n        this._element.nativeElement,\n        CLASS_NAME.FADE\n      );\n    }\n    this._renderer.setStyle(\n      this._element.nativeElement,\n      'display',\n      'block'\n    );\n    setTimeout(() => {\n      this.isShown = true;\n      this._renderer.addClass(\n        this._element.nativeElement,\n        isBs3() ? CLASS_NAME.IN : CLASS_NAME.SHOW\n      );\n    }, this.isAnimated ? TRANSITION_DURATIONS.BACKDROP : 0);\n    if (document && document.body) {\n      if (this.bsModalService && this.bsModalService.getModalsCount() === 1) {\n        this.bsModalService.checkScrollbar();\n        this.bsModalService.setScrollbar();\n      }\n      this._renderer.addClass(document.body, CLASS_NAME.OPEN);\n      this._renderer.setStyle(document.body, 'overflow-y', 'hidden');\n    }\n    if (this._element.nativeElement) {\n      this._element.nativeElement.focus();\n    }\n  }\n\n  @HostListener('mousedown', ['$event'])\n  onClickStarted(event: MouseEvent): void {\n    this.clickStartedInContent = event.target !== this._element.nativeElement;\n  }\n\n  @HostListener('click', ['$event'])\n  onClickStop(event: MouseEvent): void {\n    const clickedInBackdrop = event.target === this._element.nativeElement && !this.clickStartedInContent;\n    if (\n      this.config.ignoreBackdropClick ||\n      this.config.backdrop === 'static' ||\n      !clickedInBackdrop\n    ) {\n      this.clickStartedInContent = false;\n\n      return;\n    }\n    this.bsModalService?.setDismissReason(DISMISS_REASONS.BACKRDOP);\n    this.hide();\n  }\n\n  @HostListener('window:popstate')\n  onPopState(): void {\n    this.bsModalService?.setDismissReason(DISMISS_REASONS.BACK);\n    this.hide();\n  }\n\n  @HostListener('window:keydown.esc', ['$event'])\n  onEsc(event: KeyboardEvent): void {\n    if (!this.isShown) {\n      return;\n    }\n\n    if (event.keyCode === 27 || event.key === 'Escape') {\n      event.preventDefault();\n    }\n\n    if (\n      this.config.keyboard &&\n      this.level === this.bsModalService?.getModalsCount()\n    ) {\n      this.bsModalService?.setDismissReason(DISMISS_REASONS.ESC);\n      this.hide();\n    }\n  }\n\n  ngOnDestroy(): void {\n    if (this.isShown) {\n      this._hide();\n    }\n  }\n\n  hide(): void {\n    if (this.isModalHiding || !this.isShown) {\n      return;\n    }\n\n    if (this.config.closeInterceptor) {\n      this.config.closeInterceptor().then(\n        () => this._hide(),\n        () => undefined);\n\n      return;\n    }\n\n    this._hide();\n  }\n\n  private _hide(): void {\n    this.isModalHiding = true;\n    this._renderer.removeClass(\n      this._element.nativeElement,\n      isBs3() ? CLASS_NAME.IN : CLASS_NAME.SHOW\n    );\n    setTimeout(() => {\n      this.isShown = false;\n      if (\n        document &&\n        document.body &&\n        this.bsModalService?.getModalsCount() === 1\n      ) {\n        this._renderer.removeClass(document.body, CLASS_NAME.OPEN);\n        this._renderer.setStyle(document.body, 'overflow-y', '');\n      }\n      this.bsModalService?.hide(this.config.id);\n      this.isModalHiding = false;\n    }, this.isAnimated ? TRANSITION_DURATIONS.MODAL : 0);\n  }\n}\n"]}