{"version":3,"file":"rating.component.js","sources":["../../../../src/rating/rating.component.ts"],"names":[],"mappings":"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","sourcesContent":["import {\n  ChangeDetectionStrategy,\n  ChangeDetectorRef,\n  Component,\n  EventEmitter,\n  forwardRef,\n  HostListener,\n  Input,\n  OnInit,\n  Output,\n  Provider,\n  TemplateRef\n} from '@angular/core';\nimport { ControlValueAccessor, NG_VALUE_ACCESSOR } from '@angular/forms';\nimport { RatingResults } from './models';\nimport { RatingConfig } from './rating.config';\n\nexport const RATING_CONTROL_VALUE_ACCESSOR: Provider = {\n  provide: NG_VALUE_ACCESSOR,\n  useExisting: forwardRef(() => RatingComponent),\n  multi: true\n};\n\n@Component({\n  selector: 'rating',\n  templateUrl: './rating.component.html',\n  providers: [RATING_CONTROL_VALUE_ACCESSOR],\n  changeDetection: ChangeDetectionStrategy.OnPush\n})\nexport class RatingComponent implements ControlValueAccessor, OnInit {\n  /** number of icons */\n  @Input() max = 5;\n  /** if true will not react on any user events */\n  @Input() readonly = false;\n  /** array of icons titles, default: ([\"one\", \"two\", \"three\", \"four\", \"five\"]) */\n  @Input() titles: string[] = [];\n  /** custom template for icons */\n    // eslint-disable-next-line @typescript-eslint/no-explicit-any\n  @Input() customTemplate?: TemplateRef<any>;\n  /** fired when icon selected, $event:number equals to selected rating */\n  @Output() onHover = new EventEmitter<number>();\n  /** fired when icon selected, $event:number equals to previous rating value */\n  @Output() onLeave = new EventEmitter<number>();\n\n  onChange = Function.prototype;\n  onTouched = Function.prototype;\n  /** aria label for rating */\n  ariaLabel = 'rating';\n  range: RatingResults[] = [];\n  value = 0;\n  protected preValue?: number;\n\n  constructor(private changeDetection: ChangeDetectorRef, config: RatingConfig) {\n    Object.assign(this, config);\n  }\n\n  @HostListener('keydown', ['$event'])\n  onKeydown(event: KeyboardEvent): void {\n    if ([37, 38, 39, 40].indexOf(event.which) === -1) {\n      return;\n    }\n\n    event.preventDefault();\n    event.stopPropagation();\n    const sign = event.which === 38 || event.which === 39 ? 1 : -1;\n    this.rate(this.value + sign);\n  }\n\n  ngOnInit(): void {\n    this.max = this.max || 5;\n    this.titles =\n      typeof this.titles !== 'undefined' && this.titles.length > 0\n        ? this.titles\n        : [];\n    this.range = this.buildTemplateObjects(this.max);\n  }\n\n  // model -> view\n  writeValue(value: number): void {\n    if (value % 1 !== value) {\n      this.value = Math.round(value);\n      this.preValue = value;\n      this.changeDetection.markForCheck();\n\n      return;\n    }\n\n    this.preValue = value;\n    this.value = value;\n    this.changeDetection.markForCheck();\n  }\n\n  enter(value: number): void {\n    if (!this.readonly) {\n      this.value = value;\n      this.changeDetection.markForCheck();\n      this.onHover.emit(value);\n    }\n  }\n\n  reset(): void {\n    if (typeof this.preValue === 'number') {\n      this.value = Math.round(this.preValue);\n      this.changeDetection.markForCheck();\n      this.onLeave.emit(this.value);\n    }\n  }\n\n  registerOnChange(fn: (_: number) => void): void {\n    this.onChange = fn;\n  }\n\n  registerOnTouched(fn: () => void): void {\n    this.onTouched = fn;\n  }\n\n  rate(value: number): void {\n    if (!this.readonly && this.range\n      && value >= 0 && value <= this.range.length) {\n      this.writeValue(value);\n      this.onChange(value);\n    }\n  }\n\n  protected buildTemplateObjects(max: number): RatingResults[] {\n    const result: RatingResults[] = [];\n\n    for (let i = 0; i < max; i++) {\n      result.push({\n        index: i,\n        title: this.titles[i] || i + 1\n      });\n    }\n\n    return result;\n  }\n}\n"]}